
import java.net.*;
import java.io.*;

public class yahoo {
	static int no_comp=5;
	static long t;
	static String[] s= new String[no_comp];
    public static int main(String[] args) throws Exception {
    	t=System.currentTimeMillis();
    	System.out.println("enter value of Q ");
    	 BufferedReader rd1 = new BufferedReader(new InputStreamReader(System.in)); 
    	 int Q=Integer.parseInt(rd1.readLine());
    	 System.out.println("enter value of R ");
    	 int R=Integer.parseInt(rd1.readLine());
    	System.out.println("enter no of companies");
	    	
		no_comp=Integer.parseInt(rd1.readLine());
	
		for(int i=0;i<no_comp;i++)
		{
			System.out.println("enter company tickers");
			s[i]=rd1.readLine();
		
		}
		yahoo y=new yahoo();
		while(1==1)
		{
			if(t-System.currentTimeMillis()==(R*1000))
			{
				System.out.println("TIMEOUT!!!");
				return(1);
			}
		y.display();
		Thread.sleep(Q*1000);
		}
		return(1);
    }
		public void display()

		{
			System.out.println("Info is in format-Ticker No, Ticker, Current price, Previous close, Market Cap, Date");
		try
		{
			for(int i=0;i<no_comp;i++)
			{
		URL comp = new URL("http://in.finance.yahoo.com/d/quotes.csv?s=" + s[i] + "&f=sl1pj3d1");
			
		 URLConnection yc = comp.openConnection();
        BufferedReader rd2 = new BufferedReader(new InputStreamReader(
                                    yc.getInputStream()));
        
        String inputLine;
        
        System.out.print(i+1 + ",");
        while ((inputLine = rd2.readLine()) != null) 
            System.out.println(inputLine);
        rd2.close();
       
		
		}
		}
		catch(MalformedURLException e1)
		{
			 System.out.println("EXCEPTION DETECTED :-" + e1);
		}
		catch(IOException e2)
		{
			 System.out.println("EXCEPTION DETECTED :-" + e2);
		}
		
		}
    
    
}